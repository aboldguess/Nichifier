{#
base.html
=========
Mini-README: Master layout for Nichifier pages. Provides navigation bar, flash message
handling, Bootstrap 5 integration, and profile dropdown interactions.
#}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ title or 'Nichifier Platform' }}</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="/static/css/nichifier_styles.css" />
  </head>
  <body class="bg-light">
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm">
      <div class="container-fluid">
        <a class="navbar-brand fw-bold" href="/">Nichifier BI</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarContent"
          aria-controls="navbarContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
            <li class="nav-item"><a class="nav-link" href="/how-it-works">How it works</a></li>
            <li class="nav-item"><a class="nav-link" href="/dashboard">Dashboard</a></li>
            <li class="nav-item"><a class="nav-link" href="/subscriptions/manage">Subscriptions</a></li>
            {% if user and user.role in ['admin', 'niche_admin'] %}
            <li class="nav-item"><a class="nav-link" href="/niches/manage/create">Add Niche</a></li>
            {% else %}
            <li class="nav-item"><a class="nav-link" href="/premium">Add Niche</a></li>
            {% endif %}
            <li class="nav-item"><a class="nav-link" href="/admin/dashboard">Admin</a></li>
          </ul>
          <div class="d-flex align-items-center gap-3">
            {% if user %}
            <div class="dropdown">
              <button
                class="btn btn-outline-light dropdown-toggle d-flex align-items-center"
                type="button"
                id="profileMenuButton"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <img
                  src="https://ui-avatars.com/api/?background=0D8ABC&color=fff&name={{ user.full_name|replace(' ', '+') }}"
                  alt="Profile"
                  class="rounded-circle me-2"
                  width="36"
                  height="36"
                />
                <span>{{ user.full_name }}</span>
              </button>
              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileMenuButton">
                <li><a class="dropdown-item" href="#">Manage Profiles</a></li>
                <li><a class="dropdown-item" href="#">Learning Zone</a></li>
                <li><a class="dropdown-item" href="#">My Details</a></li>
                <li><a class="dropdown-item" href="/subscriptions/manage">Subscription Details</a></li>
                <li><a class="dropdown-item" href="#">Manage Users</a></li>
                <li><hr class="dropdown-divider" /></li>
                <li><a class="dropdown-item text-danger" href="/auth/logout">Sign out</a></li>
              </ul>
            </div>
            {% else %}
            <a class="btn btn-outline-light" href="/auth/login">Sign in</a>
            <a class="btn btn-warning" href="/auth/register">Create account</a>
            {% endif %}
          </div>
        </div>
      </div>
    </nav>

    <main class="container py-4">
      {% block instructions %}
      <div class="alert alert-info" role="alert">
        Welcome to Nichifier! Use the buttons above to explore niches, sign up for
        newsletters, and manage your subscriptions. Instructions appear on every page so
        you never need to hunt for help.
      </div>
      {% endblock %}
      {% block content %}{% endblock %}
    </main>

    <footer class="bg-white border-top py-4 mt-auto">
      <div class="container d-flex justify-content-between">
        <span class="text-muted">&copy; {{ current_year|default(2024) }} Nichifier BI Platform</span>
        <span class="text-muted">Crafted with security-first design and modern UX.</span>
      </div>
    </footer>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
